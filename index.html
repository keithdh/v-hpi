<!DOCTYPE html>
<html>
    <head>
        <title>Chernoff faces</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <script type="text/javascript" src="../d3.js"></script>
    </head>

    <body>
        <div id="face"></div>
        <script type="text/javascript">
        function sign(num) {
            if(num > 0) {
                return 1;
            } else if(num < 0) {
                return -1;
            } else {
                return 0;
            }
        }
        (function () {
        var width = 140,
            height = 160,
            svg = d3.select("#face")
                .append("svg:svg")
                .attr("height", height)
                .attr("width", width),

            facef = 0.5, // 0 - 1
            facevar = facef * 30,

            hairf = -0.5, // -1 - 1
            hairvar = hairf * 80,

            mouthf = 1, // -1 - 1
            mouthvar = mouthf * 7,

            nosehf = 1, // 0 - 1
            nosewf = 0.5, // 0 - 1
            nosehvar = nosehf * 10,
            nosewvar = nosewf * 10,

            eyehf = 0.8, // 0 - 1
            eyewf = 1, // 0 - 1
            eyehvar = eyehf * 10,
            eyewvar = eyewf * 10,

            browf = 1, // -1 - 1
            browvar = browf * 3,

            line = d3.svg.line()
                .interpolate("cardinal-closed")
                .x(function(d) { return d.x; })
                .y(function(d) { return d.y; }),
            bline = d3.svg.line()
                .interpolate("basis-closed")
                .x(function(d) { return d.x; })
                .y(function(d) { return d.y; });

        var face = [{x: 70, y: 60}, {x: 120, y: 80},
                    {x: 120-facevar, y: 110}, {x: 120-facevar, y: 160},
                    {x: 20+facevar, y: 160}, {x: 20+facevar, y: 110},
                    {x: 20, y: 80}];
        svg.selectAll("path.face").data([face]).enter()
            .append("svg:path")
            .attr("class", "face")
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("d", bline);

        var hair = [{x: 70, y: 60}, {x: 120, y: 80},
                    {x: 140, y: 45-hairvar}, {x: 120, y: 45},
                    {x: 70, y: 30}, {x: 20, y: 45},
                    {x: 0, y: 45-hairvar}, {x: 20, y: 80}];
        svg.selectAll("path.hair").data([hair]).enter()
            .append("svg:path")
            .attr("class", "hair")
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("d", bline);

        var mouth = [{x: 70, y: 130+mouthvar},
                     {x: 110-facevar, y: 135-mouthvar},
                     {x: 70, y: 140+mouthvar},
                     {x: 30+facevar, y: 135-mouthvar}];
        svg.selectAll("path.mouth").data([mouth]).enter()
            .append("svg:path")
            .attr("class", "mouth")
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("d", line);

        var nose = [{x: 70, y: 110-nosehvar},
                    {x: 70+nosewvar, y: 110+nosehvar},
                    {x: 70-nosewvar, y: 110+nosehvar}];
        svg.selectAll("path.nose").data([nose]).enter()
            .append("svg:path")
            .attr("class", "nose")
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("d", line);

        var leye = [{x: 55, y: 90-eyehvar}, {x: 55+eyewvar, y: 90},
                    {x: 55, y: 90+eyehvar}, {x: 55-eyewvar, y: 90}];
        var reye = [{x: 85, y: 90-eyehvar}, {x: 85+eyewvar, y: 90},
                    {x: 85, y: 90+eyehvar}, {x: 85-eyewvar, y: 90}];
        svg.selectAll("path.leye").data([leye]).enter()
            .append("svg:path")
            .attr("class", "leye")
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("d", bline);
        svg.selectAll("path.reye").data([reye]).enter()
            .append("svg:path")
            .attr("class", "reye")
            .attr("fill", "none")
            .attr("stroke", "#000")
            .attr("d", bline);

        svg.append("svg:path")
            .attr("class", "lbrow")
            .attr("stroke", "#000")
            .attr("d", "M" + (55-eyewvar/1.7-sign(browvar)) + "," +
                       (87-eyehvar+browvar) + " " +
                       (55+eyewvar/1.7-sign(browvar)) + "," +
                       (87-eyehvar-browvar));
        svg.append("svg:path")
            .attr("class", "rbrow")
            .attr("stroke", "#000")
            .attr("d", "M" + (85-eyewvar/1.7+sign(browvar)) + "," +
                       (87-eyehvar-browvar) + " " +
                       (85+eyewvar/1.7+sign(browvar)) + "," +
                       (87-eyehvar+browvar));
        })();
        </script>
    </body>
</html>
